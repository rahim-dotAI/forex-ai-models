name: AI Forex Notebook Runner

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  run-notebook:
    runs-on: ubuntu-latest

    env:
      GITHUB_USERNAME: rahim-dotAI
      GITHUB_REPO: forex-ai-models
      GITHUB_PAT: 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
      GIT_USER_EMAIL: nakatonabira3@gmail.com

    steps:
    - name: Checkout repo
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: 3.11

    - name: Upgrade pip
      run: python -m pip install --upgrade pip

    - name: Install Python dependencies
      run: |
        pip install papermill jupyter nbformat pandas numpy matplotlib scikit-learn gitpython

    - name: Create output folder
      run: mkdir -p output

    - name: Execute AI Forex Notebook
      run: |
        papermill "AI_Forex_Brain 2.ipynb" "output/AI_Forex_Brain_Executed.ipynb"

    - name: Upload Executed Notebook as Artifact
      uses: actions/upload-artifact@v4
      with:
        name: executed-notebook
        path: output/AI_Forex_Brain_Executed.ipynb
