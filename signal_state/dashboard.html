<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Beacon Pro | Live Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--bg:#0a0e1a;--surface:#111827;--surface-light:#1f2937;--surface-hover:#252d3d;
--border:#374151;--border-hover:#4b5563;--text:#f9fafb;--text-dim:#9ca3af;--text-dimmer:#6b7280;
--primary:#3b82f6;--primary-dark:#2563eb;--success:#10b981;--success-dark:#059669;
--danger:#ef4444;--danger-dark:#dc2626;--warning:#f59e0b;--warning-dark:#d97706;
--purple:#a855f7;--purple-dark:#9333ea;--cyan:#06b6d4;--cyan-dark:#0891b2;
}
body{
font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);overflow-x:hidden;
background-image:radial-gradient(circle at 20% 50%,rgba(59,130,246,0.03) 0%,transparent 50%),
radial-gradient(circle at 80% 80%,rgba(168,85,247,0.03) 0%,transparent 50%);
}

/* NAVBAR */
.navbar{
display:flex;justify-content:space-between;align-items:center;
padding:20px 40px;background:rgba(17,24,39,0.8);
border-bottom:1px solid var(--border);
backdrop-filter:blur(20px);position:sticky;top:0;z-index:1000;
transition:all 0.3s ease;
}
.navbar:hover{background:rgba(17,24,39,0.95)}

.logo{
font-size:28px;font-weight:900;letter-spacing:-1px;
display:flex;align-items:center;gap:14px;
transition:transform 0.3s ease;
}
.logo:hover{transform:scale(1.02)}
.logo-text{
background:linear-gradient(135deg,var(--primary),var(--purple));
-webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.logo-icon{
width:44px;height:44px;
background:linear-gradient(135deg,var(--primary),var(--purple));
border-radius:14px;display:flex;align-items:center;justify-content:center;
box-shadow:0 10px 30px rgba(59,130,246,0.3);
position:relative;overflow:hidden;
}
.logo-icon::before{
content:'';position:absolute;inset:0;
background:linear-gradient(45deg,transparent,rgba(255,255,255,0.3),transparent);
transform:translateX(-100%);
}
.logo-icon:hover::before{
animation:shine 0.6s ease;
}
@keyframes shine{to{transform:translateX(100%)}}

.logo-icon svg{width:24px;height:24px;fill:white}

.nav-actions{display:flex;align-items:center;gap:16px}

.status-pill{
padding:10px 20px;border-radius:24px;font-size:13px;font-weight:700;
display:flex;align-items:center;gap:10px;
transition:all 0.3s ease;cursor:default;
}
.status-live{background:rgba(16,185,129,.15);color:var(--success);border:2px solid var(--success);box-shadow:0 0 20px rgba(16,185,129,0.2)}
.status-stale{background:rgba(245,158,11,.15);color:var(--warning);border:2px solid var(--warning);box-shadow:0 0 20px rgba(245,158,11,0.2)}
.status-offline{background:rgba(239,68,68,.15);color:var(--danger);border:2px solid var(--danger);box-shadow:0 0 20px rgba(239,68,68,0.2)}

.pulse{
width:10px;height:10px;border-radius:50%;background:currentColor;
position:relative;
}
.pulse::before{
content:'';position:absolute;inset:-4px;
border-radius:50%;border:2px solid currentColor;
animation:pulsate 2s infinite;
}
@keyframes pulsate{
0%,100%{opacity:1;transform:scale(1)}
50%{opacity:0;transform:scale(1.5)}
}

.refresh-btn{
padding:10px 20px;
background:var(--surface-light);
border:2px solid var(--border);
border-radius:14px;
color:var(--text);
font-size:13px;
font-weight:600;
cursor:pointer;
transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
display:flex;
align-items:center;
gap:10px;
position:relative;
overflow:hidden;
}
.refresh-btn::before{
content:'';position:absolute;inset:0;
background:linear-gradient(135deg,var(--primary),var(--purple));
opacity:0;transition:opacity 0.3s;
}
.refresh-btn:hover{
border-color:var(--primary);
transform:translateY(-2px);
box-shadow:0 10px 30px rgba(59,130,246,0.3);
}
.refresh-btn:hover::before{opacity:0.1}
.refresh-btn:active .refresh-icon{
animation:rotate360 0.5s ease;
}
@keyframes rotate360{to{transform:rotate(360deg)}}

.refresh-icon{
display:flex;transition:transform 0.3s;
position:relative;z-index:1;
}
.refresh-icon svg{width:16px;height:16px;stroke:currentColor}
.refresh-btn span:last-child{position:relative;z-index:1}

.container{max-width:1600px;margin:auto;padding:40px}
.grid{display:grid;gap:28px}
.grid-4{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
.grid-2{grid-template-columns:1.5fr 1fr}
@media(max-width:1200px){.grid-2{grid-template-columns:1fr}}

.card,.metric-card{
background:var(--surface);
border:1px solid var(--border);
border-radius:24px;padding:32px;
transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
position:relative;overflow:hidden;
}
.card::before,.metric-card::before{
content:'';position:absolute;top:0;right:0;
width:200px;height:200px;
background:radial-gradient(circle,rgba(59,130,246,0.05),transparent);
opacity:0;transition:opacity 0.4s;
}
.card:hover::before,.metric-card:hover::before{opacity:1}
.card:hover,.metric-card:hover{
transform:translateY(-6px);
border-color:var(--border-hover);
box-shadow:0 20px 60px rgba(0,0,0,0.4);
}

.metric-card{text-align:center}
.metric-icon{
width:56px;height:56px;margin:0 auto 16px;
background:linear-gradient(135deg,var(--surface-light),var(--surface-hover));
border-radius:16px;display:flex;align-items:center;justify-content:center;
border:2px solid var(--border);
transition:all 0.3s;
}
.metric-card:hover .metric-icon{
transform:scale(1.1) rotateY(10deg);
border-color:var(--primary);
}
.metric-icon svg{width:28px;height:28px}

.metric-label{
font-size:13px;color:var(--text-dim);text-transform:uppercase;
letter-spacing:1.5px;font-weight:600;margin-bottom:12px;
}
.metric-value{
font-size:44px;font-weight:900;letter-spacing:-2px;
background:linear-gradient(135deg,currentColor,currentColor);
-webkit-background-clip:text;
transition:all 0.3s;
}
.metric-card:hover .metric-value{
transform:scale(1.05);
}

/* MODE SWITCHER */
.mode-switcher{
background:linear-gradient(135deg,rgba(59,130,246,0.05),rgba(168,85,247,0.05));
border:2px solid var(--border);
border-radius:28px;
padding:40px;
margin-bottom:40px;
position:relative;
overflow:hidden;
}
.mode-switcher::before{
content:'';position:absolute;
top:-50%;left:-50%;
width:200%;height:200%;
background:conic-gradient(from 0deg,transparent 0deg,rgba(59,130,246,0.1) 90deg,transparent 180deg);
animation:rotateGlow 10s linear infinite;
pointer-events:none;
}
@keyframes rotateGlow{to{transform:rotate(360deg)}}

.mode-switcher > *{position:relative;z-index:1}

.mode-header{
display:flex;align-items:center;gap:16px;margin-bottom:32px;
}
.mode-header-icon{
width:60px;height:60px;
background:linear-gradient(135deg,var(--primary),var(--purple));
border-radius:18px;display:flex;align-items:center;justify-content:center;
box-shadow:0 10px 40px rgba(59,130,246,0.3);
animation:floatSlow 4s ease-in-out infinite;
}
@keyframes floatSlow{
0%,100%{transform:translateY(0) rotateY(0deg)}
50%{transform:translateY(-10px) rotateY(10deg)}
}
.mode-header-icon svg{width:32px;height:32px;fill:white}

.mode-header h3{
font-size:28px;font-weight:900;
background:linear-gradient(135deg,var(--text),var(--text-dim));
-webkit-background-clip:text;-webkit-text-fill-color:transparent;
letter-spacing:-0.5px;
}

.mode-toggle{
display:grid;
grid-template-columns:1fr 1fr;
gap:24px;
margin-bottom:24px;
}
.mode-btn{
padding:32px;
border:3px solid var(--border);
border-radius:24px;
background:var(--surface-light);
color:var(--text);
cursor:pointer;
transition:all 0.5s cubic-bezier(0.4,0,0.2,1);
text-align:center;
position:relative;
overflow:hidden;
}
.mode-btn::before{
content:'';position:absolute;inset:0;
background:linear-gradient(135deg,var(--primary),var(--purple));
opacity:0;transition:opacity 0.5s;
}
.mode-btn::after{
content:'';position:absolute;
top:50%;left:50%;
width:0;height:0;
border-radius:50%;
background:radial-gradient(circle,rgba(255,255,255,0.3),transparent);
transform:translate(-50%,-50%);
transition:width 0.6s,height 0.6s;
}
.mode-btn:hover::after{width:500px;height:500px}
.mode-btn:hover{
transform:translateY(-8px) scale(1.02);
border-color:var(--primary);
box-shadow:0 20px 60px rgba(59,130,246,0.3);
}
.mode-btn.active{
background:linear-gradient(135deg,var(--primary),var(--purple));
border-color:transparent;
transform:translateY(-6px) scale(1.03);
box-shadow:0 20px 80px rgba(59,130,246,0.5);
}
.mode-btn.active::before{opacity:1}
.mode-btn.active .mode-icon-wrapper{
animation:bounceRotate 0.8s ease-in-out;
}
@keyframes bounceRotate{
0%,100%{transform:scale(1) rotateZ(0deg)}
50%{transform:scale(1.2) rotateZ(360deg)}
}

.mode-btn > *{position:relative;z-index:1}

.mode-icon-wrapper{
width:64px;height:64px;margin:0 auto 16px;
background:rgba(255,255,255,0.1);
border-radius:18px;
display:flex;align-items:center;justify-content:center;
transition:all 0.4s;
}
.mode-btn:hover .mode-icon-wrapper{
transform:scale(1.15) rotateY(15deg) rotateX(10deg);
}
.mode-btn.active .mode-icon-wrapper{
background:rgba(255,255,255,0.2);
}
.mode-icon-wrapper svg{width:36px;height:36px;fill:currentColor}

.mode-btn .mode-title{
font-size:22px;font-weight:800;margin-bottom:10px;
}
.mode-btn .mode-desc{
font-size:14px;opacity:0.85;font-weight:400;line-height:1.6;
}
.mode-badge{
display:inline-block;
padding:8px 18px;
border-radius:20px;
font-size:11px;
font-weight:800;
margin-top:16px;
text-transform:uppercase;
letter-spacing:1.2px;
backdrop-filter:blur(10px);
}
.mode-badge.conservative{
background:rgba(16,185,129,.3);
color:var(--success);
border:1px solid var(--success);
}
.mode-badge.aggressive{
background:rgba(239,68,68,.3);
color:var(--danger);
border:1px solid var(--danger);
}

.mode-info{
padding:24px;
background:var(--surface-light);
border-radius:20px;
font-size:14px;
line-height:1.9;
border-left:5px solid var(--primary);
box-shadow:0 10px 30px rgba(0,0,0,0.2);
}
.mode-info strong{color:var(--primary);font-weight:700}

/* SIGNAL CARDS */
.signal-card{
background:var(--surface-light);
border-radius:20px;
padding:24px;margin-bottom:20px;
border-left:5px solid;
transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
position:relative;
overflow:hidden;
}
.signal-card::before{
content:'';position:absolute;
top:0;right:0;
width:150px;height:150px;
background:radial-gradient(circle,rgba(255,255,255,0.03),transparent);
transition:all 0.4s;
}
.signal-card:hover{
transform:translateX(12px) scale(1.02);
box-shadow:0 15px 40px rgba(0,0,0,0.4);
border-left-width:8px;
}
.signal-card:hover::before{
width:300px;height:300px;
}
.signal-card.buy{border-color:var(--success);background:linear-gradient(135deg,var(--surface-light),rgba(16,185,129,0.05))}
.signal-card.sell{border-color:var(--danger);background:linear-gradient(135deg,var(--surface-light),rgba(239,68,68,0.05))}

.signal-header{
display:flex;align-items:center;justify-content:space-between;
margin-bottom:16px;
}
.signal-pair{
font-size:22px;font-weight:800;
display:flex;align-items:center;gap:12px;
}
.signal-direction{
display:inline-flex;
align-items:center;
gap:6px;
padding:6px 14px;
border-radius:14px;
font-size:12px;
font-weight:700;
text-transform:uppercase;
letter-spacing:0.5px;
}
.signal-direction.buy{background:rgba(16,185,129,.2);color:var(--success);border:2px solid var(--success)}
.signal-direction.sell{background:rgba(239,68,68,.2);color:var(--danger);border:2px solid var(--danger)}
.signal-direction svg{width:14px;height:14px;fill:currentColor}

.signal-confidence{
padding:6px 14px;
border-radius:14px;
font-size:11px;
font-weight:700;
text-transform:uppercase;
letter-spacing:0.5px;
background:rgba(59,130,246,.2);
color:var(--primary);
border:2px solid var(--primary);
}

.signal-metrics{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
gap:12px;
margin-top:16px;
}
.signal-metric{
padding:12px;
background:var(--surface);
border-radius:12px;
border:1px solid var(--border);
transition:all 0.3s;
}
.signal-metric:hover{
border-color:var(--primary);
transform:translateY(-2px);
}
.signal-metric-label{
font-size:11px;
color:var(--text-dimmer);
text-transform:uppercase;
letter-spacing:0.5px;
margin-bottom:4px;
font-weight:600;
}
.signal-metric-value{
font-size:16px;
font-weight:800;
color:var(--text);
}

.signal-footer{
margin-top:16px;
padding-top:16px;
border-top:1px solid var(--border);
display:flex;
align-items:center;
gap:8px;
font-size:12px;
color:var(--text-dim);
}
.signal-footer svg{width:14px;height:14px;stroke:currentColor}

.loading-overlay{
position:fixed;inset:0;
background:linear-gradient(135deg,rgba(10,14,26,0.98),rgba(17,24,39,0.98));
display:flex;align-items:center;justify-content:center;
z-index:9999;backdrop-filter:blur(20px);
}
.loading-content{text-align:center}
.loading-spinner{
width:80px;height:80px;
border:8px solid var(--border);
border-top-color:var(--primary);
border-bottom-color:var(--purple);
border-radius:50%;
animation:spin 1s linear infinite;
margin:0 auto 24px;
filter:drop-shadow(0 0 30px rgba(59,130,246,0.6));
position:relative;
}
.loading-spinner::before{
content:'';position:absolute;
inset:12px;
border:4px solid transparent;
border-top-color:var(--cyan);
border-radius:50%;
animation:spin 1.5s linear infinite reverse;
}
@keyframes spin{to{transform:rotate(360deg)}}

.settings-row{
display:flex;
justify-content:space-between;
padding:20px 0;
border-bottom:1px solid var(--border);
align-items:center;
transition:all 0.3s;
}
.settings-row:hover{background:rgba(59,130,246,0.02);padding-left:8px}
.settings-row:last-child{border:none}
.settings-label{
color:var(--text-dim);font-size:14px;font-weight:600;
display:flex;align-items:center;gap:10px;
}
.settings-label svg{width:18px;height:18px;stroke:currentColor}
.settings-value{
font-weight:800;
padding:8px 18px;
background:var(--surface-light);
border-radius:14px;
font-size:14px;
border:2px solid var(--border);
transition:all 0.3s;
}
.settings-row:hover .settings-value{
border-color:var(--primary);
box-shadow:0 0 20px rgba(59,130,246,0.2);
}

.notification{
position:fixed;
top:100px;right:40px;
background:var(--surface);
border:2px solid var(--primary);
border-radius:20px;
padding:24px 32px;
z-index:10000;
animation:slideIn 0.5s cubic-bezier(0.4,0,0.2,1);
box-shadow:0 20px 60px rgba(59,130,246,0.4);
max-width:420px;
display:flex;
align-items:center;
gap:16px;
backdrop-filter:blur(20px);
}
.notification-icon{
width:48px;height:48px;
border-radius:14px;
display:flex;align-items:center;justify-content:center;
flex-shrink:0;
}
.notification-icon svg{width:24px;height:24px}
.notification.success{border-color:var(--success)}
.notification.success .notification-icon{background:rgba(16,185,129,.2);color:var(--success)}
.notification.error{border-color:var(--danger)}
.notification.error .notification-icon{background:rgba(239,68,68,.2);color:var(--danger)}
.notification.warning{border-color:var(--warning)}
.notification.warning .notification-icon{background:rgba(245,158,11,.2);color:var(--warning)}
.notification.info{border-color:var(--primary)}
.notification.info .notification-icon{background:rgba(59,130,246,.2);color:var(--primary)}

@keyframes slideIn{from{transform:translateX(600px);opacity:0}}
@keyframes slideOut{to{transform:translateX(600px);opacity:0}}

h3{margin-bottom:24px;font-size:22px;font-weight:800;display:flex;align-items:center;gap:12px}
h3 svg{width:24px;height:24px}

.empty-state{
text-align:center;
padding:60px 40px;
color:var(--text-dim);
}
.empty-state-icon{
width:80px;height:80px;
margin:0 auto 20px;
background:var(--surface-light);
border-radius:20px;
display:flex;align-items:center;justify-content:center;
border:2px solid var(--border);
}
.empty-state-icon svg{width:40px;height:40px;stroke:currentColor}
.empty-state-title{font-size:18px;font-weight:700;color:var(--text);margin-bottom:8px}
.empty-state-desc{font-size:14px;line-height:1.6}

@media(max-width:768px){
.navbar{padding:16px 20px}
.container{padding:24px 20px}
.mode-toggle{grid-template-columns:1fr;gap:16px}
.grid-4{grid-template-columns:1fr}
.notification{right:20px;max-width:calc(100vw - 40px)}
}
</style>
</head>

<body>

<div class="loading-overlay" id="loading">
<div class="loading-content">
<div class="loading-spinner"></div>
<p style="font-size:20px;font-weight:700;color:var(--text);margin-bottom:8px">Initializing Trade Beacon</p>
<p style="font-size:14px;color:var(--text-dim)">Loading real-time market data...</p>
</div>
</div>

<nav class="navbar">
<div class="logo">
<div class="logo-icon">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2L2 7L12 12L22 7L12 2Z" fill="white"/>
<path d="M2 17L12 22L22 17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 12L12 17L22 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
<div>Trade<span class="logo-text">Beacon</span></div>
</div>
<div class="nav-actions">
<button class="refresh-btn" onclick="forceRefresh()">
<span class="refresh-icon">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M1 4V10H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M23 20V14H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10M23 14L18.36 18.36A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</span>
<span>Refresh</span>
</button>
<div class="status-pill status-live" id="health">
<span class="pulse"></span>
<span id="healthText">LIVE</span>
</div>
</div>
</nav>

<div class="container">

<!-- MODE SWITCHER -->
<div class="mode-switcher">
<div class="mode-header">
<div class="mode-header-icon">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10" fill="white"/>
<path d="M12 6V12L16 14" stroke="#3b82f6" stroke-width="2" stroke-linecap="round"/>
</svg>
</div>
<h3>Trading Strategy Mode</h3>
</div>
<div class="mode-toggle">
<button class="mode-btn" id="btnConservative" onclick="setMode('conservative')">
<div class="mode-icon-wrapper">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 22C12 22 3 18 3 11V5L12 2L21 5V11C21 18 12 22 12 22Z" fill="currentColor"/>
</svg>
</div>
<div class="mode-title">High Confidence</div>
<div class="mode-desc">Premium quality signals with strict filtering criteria</div>
<span class="mode-badge conservative">Quality First</span>
</button>
<button class="mode-btn active" id="btnAggressive" onclick="setMode('aggressive')">
<div class="mode-icon-wrapper">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" fill="currentColor"/>
</svg>
</div>
<div class="mode-title">Aggressive</div>
<div class="mode-desc">Maximum opportunities with flexible criteria</div>
<span class="mode-badge aggressive">Volume First</span>
</button>
</div>
<div class="mode-info" id="modeInfo">
<strong>Active Configuration:</strong> Aggressive Mode • Threshold: 30 • Min ADX: None • RSI: Any
</div>
</div>

<!-- METRICS -->
<div class="grid grid-4">
<div class="metric-card">
<div class="metric-icon" style="border-color:var(--primary)">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="var(--primary)">
<path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
<div class="metric-label">Active Signals</div>
<div class="metric-value" style="color:var(--primary)" id="activeSignals">0</div>
</div>
<div class="metric-card">
<div class="metric-icon" style="border-color:var(--success)">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="var(--success)">
<path d="M22 12H18L15 21L9 3L6 12H2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
<div class="metric-label">Win Rate</div>
<div class="metric-value" style="color:var(--success)" id="winRate">0%</div>
</div>
<div class="metric-card">
<div class="metric-icon" style="border-color:var(--warning)">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="var(--warning)">
<path d="M12 2V6M12 18V22M4.93 4.93L7.76 7.76M16.24 16.24L19.07 19.07M2 12H6M18 12H22M4.93 19.07L7.76 16.24M16.24 7.76L19.07 4.93" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<circle cx="12" cy="12" r="3" stroke-width="2"/>
</svg>
</div>
<div class="metric-label">Total Pips</div>
<div class="metric-value" style="color:var(--warning)" id="totalPips">0</div>
</div>
<div class="metric-card">
<div class="metric-icon" style="border-color:var(--cyan)">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="var(--cyan)">
<path d="M3 3V21M21 21H3M7 16L12 11L16 15L21 10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</div>
<div class="metric-label">Today</div>
<div class="metric-value" style="color:var(--cyan)" id="dailyPips">0</div>
</div>
</div>

<div class="grid grid-2" style="margin-top:32px">

<div class="card">
<h3>
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor">
<circle cx="12" cy="12" r="10" stroke-width="2"/>
<path d="M12 6V12L16 14" stroke-width="2" stroke-linecap="round"/>
</svg>
Active Trading Signals
</h3>
<div id="signals"></div>
</div>

<div class="card">
<h3>
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor">
<circle cx="12" cy="12" r="3" stroke-width="2"/>
<path d="M12 1V3M12 21V23M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22" stroke-width="2" stroke-linecap="round"/>
</svg>
System Configuration
</h3>
<div class="settings-row">
<span class="settings-label">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
<path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
</svg>
Last Update
</span>
<span class="settings-value" id="lastUpdate">-</span>
</div>
<div class="settings-row">
<span class="settings-label">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M21 16V8C21 6.9 20.1 6 19 6H5C3.9 6 3 6.9 3 8V16C3 17.1 3.9 18 5 18H19C20.1 18 21 17.1 21 16Z" stroke="currentColor" stroke-width="2"/>
<path d="M3 10H21" stroke="currentColor" stroke-width="2"/>
</svg>
API Calls
</span>
<span class="settings-value" id="apiCalls">-</span>
</div>
<div class="settings-row">
<span class="settings-label">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
Signal Threshold
</span>
<span class="settings-value" id="currentThreshold">30</span>
</div>
<div class="settings-row">
<span class="settings-label">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M22 12H18L15 21L9 3L6 12H2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
Minimum ADX
</span>
<span class="settings-value" id="currentADX">None</span>
</div>
<div class="settings-row">
<span class="settings-label">
<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 3V21M21 21H3M7 11L12 16L21 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
RSI Filter
</span>
<span class="settings-value" id="currentRSI">Any</span>
</div>
</div>

</div>
</div>

<script>
// Use raw GitHub URL instead of API endpoint - no rate limits, no base64 decoding needed
const API_URL = 'https://raw.githubusercontent.com/rahim-dotAI/forex-ai-models/main/signal_state/dashboard_state.json';

const MODES = {
  conservative: {
    name: 'High Confidence',
    threshold: 50,
    minADX: 20,
    rsiOversold: 35,
    rsiOverbought: 65,
    description: 'High Confidence Mode • Threshold: 50 • Min ADX: 20 • RSI: <35 or >65'
  },
  aggressive: {
    name: 'Aggressive',
    threshold: 30,
    minADX: null,
    rsiOversold: 40,
    rsiOverbought: 60,
    description: 'Aggressive Mode • Threshold: 30 • Min ADX: None • RSI: Any'
  }
};

let currentMode = 'aggressive';
let lastSuccess = null;

function setMode(mode) {
  currentMode = mode;
  
  document.getElementById('btnConservative').classList.toggle('active', mode === 'conservative');
  document.getElementById('btnAggressive').classList.toggle('active', mode === 'aggressive');
  
  const config = MODES[mode];
  document.getElementById('modeInfo').innerHTML = `<strong>Active Configuration:</strong> ${config.description}`;
  document.getElementById('currentThreshold').textContent = config.threshold;
  document.getElementById('currentADX').textContent = config.minADX || 'None';
  document.getElementById('currentRSI').textContent = 
    config.minADX ? `<${config.rsiOversold} or >${config.rsiOverbought}` : 'Any';
  
  localStorage.setItem('tradeBeaconMode', mode);
  showNotification(`Switched to ${config.name} mode`, 'success');
}

function showNotification(msg, type = 'info') {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  
  const icon = document.createElement('div');
  icon.className = 'notification-icon';
  
  let iconSvg = '';
  if (type === 'success') {
    iconSvg = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
  } else if (type === 'error') {
    iconSvg = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M15 9L9 15M9 9L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>';
  } else if (type === 'warning') {
    iconSvg = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 9V13M12 17H12.01M10.29 3.86L1.82 18C1.64 18.31 1.54 18.66 1.53 19.02C1.52 19.38 1.6 19.73 1.77 20.05C1.93 20.37 2.18 20.64 2.48 20.84C2.78 21.04 3.13 21.16 3.48 21.17H20.52C20.87 21.16 21.22 21.04 21.52 20.84C21.82 20.64 22.07 20.37 22.23 20.05C22.4 19.73 22.48 19.38 22.47 19.02C22.46 18.66 22.36 18.31 22.18 18L13.71 3.86C13.53 3.56 13.28 3.3 12.98 3.11C12.68 2.92 12.34 2.81 12 2.81C11.66 2.81 11.32 2.92 11.02 3.11C10.72 3.3 10.47 3.56 10.29 3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
  } else {
    iconSvg = '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M12 16V12M12 8H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>';
  }
  
  icon.innerHTML = iconSvg;
  
  const text = document.createElement('div');
  text.textContent = msg;
  text.style.fontWeight = '600';
  text.style.fontSize = '14px';
  
  notification.appendChild(icon);
  notification.appendChild(text);
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideOut 0.5s cubic-bezier(0.4,0,0.2,1)';
    setTimeout(() => notification.remove(), 500);
  }, 3500);
}

function parseTime(iso){
  if(!iso) return '-';
  try {
    return new Date(iso.replace('+00:00','Z')).toLocaleString();
  } catch {
    return iso;
  }
}

function setHealth(state){
  const el=document.getElementById('health');
  const txt=document.getElementById('healthText');
  el.className='status-pill status-'+state;
  txt.textContent=state.toUpperCase();
}

async function fetchState(){
  try {
    const timestamp = new Date().getTime();
    // Fetch raw JSON directly - no base64 decoding needed, no API rate limits
    const r = await fetch(`${API_URL}?t=${timestamp}`, {
      cache: 'no-store',
      headers: {
        'Cache-Control': 'no-cache'
      }
    });
    if(!r.ok) throw new Error(`HTTP ${r.status}`);
    const data = await r.json();
    return data;
  } catch(err) {
    console.error('Fetch error:', err);
    throw err;
  }
}

function render(d){
  document.getElementById('loading').style.display='none';
  lastSuccess=Date.now();
  setHealth('live');

  document.getElementById('activeSignals').textContent=d.active_signals || 0;
  document.getElementById('winRate').textContent=(d.stats?.win_rate || 0).toFixed(1)+'%';
  document.getElementById('totalPips').textContent=(d.stats?.total_pips || 0).toFixed(1);
  document.getElementById('dailyPips').textContent=(d.risk_management?.daily_pips || 0).toFixed(1);

  document.getElementById('lastUpdate').textContent=parseTime(d.timestamp);
  document.getElementById('apiCalls').textContent=d.api_usage?.yfinance?.calls || 0;

  const signals = d.signals || [];
  const html=signals.map(s=>{
    const dir = s.direction.toLowerCase();
    const directionIcon = dir === 'buy' 
      ? '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 19V5M5 12L12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
      : '<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5V19M5 12L12 19L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    
    return `
    <div class="signal-card ${dir}">
      <div class="signal-header">
        <div class="signal-pair">
          ${s.pair}
          <span class="signal-direction ${dir}">
            ${directionIcon}
            ${s.direction}
          </span>
        </div>
        ${s.confidence ? `<span class="signal-confidence">${s.confidence}</span>` : ''}
      </div>
      
      <div class="signal-metrics">
        ${s.entry_price ? `
          <div class="signal-metric">
            <div class="signal-metric-label">Entry Price</div>
            <div class="signal-metric-value">${s.entry_price.toFixed(5)}</div>
          </div>
        ` : ''}
        ${s.sl ? `
          <div class="signal-metric">
            <div class="signal-metric-label">Stop Loss</div>
            <div class="signal-metric-value" style="color:var(--danger)">${s.sl.toFixed(5)}</div>
          </div>
        ` : ''}
        ${s.tp ? `
          <div class="signal-metric">
            <div class="signal-metric-label">Take Profit</div>
            <div class="signal-metric-value" style="color:var(--success)">${s.tp.toFixed(5)}</div>
          </div>
        ` : ''}
        ${s.score ? `
          <div class="signal-metric">
            <div class="signal-metric-label">Score</div>
            <div class="signal-metric-value" style="color:var(--primary)">${s.score}</div>
          </div>
        ` : ''}
        ${s.rsi ? `
          <div class="signal-metric">
            <div class="signal-metric-label">RSI</div>
            <div class="signal-metric-value">${s.rsi.toFixed(1)}</div>
          </div>
        ` : ''}
        ${s.adx ? `
          <div class="signal-metric">
            <div class="signal-metric-label">ADX</div>
            <div class="signal-metric-value">${s.adx.toFixed(1)}</div>
          </div>
        ` : ''}
      </div>
      
      ${s.timestamp ? `
        <div class="signal-footer">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          ${parseTime(s.timestamp)}
        </div>
      ` : ''}
    </div>
    `;
  }).join('');

  document.getElementById('signals').innerHTML = html || `
    <div class="empty-state">
      <div class="empty-state-icon">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
          <path d="M12 8V12M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <div class="empty-state-title">No Active Signals</div>
      <div class="empty-state-desc">Waiting for market conditions to generate new trading opportunities</div>
    </div>
  `;
}

async function update(){
  try {
    const data = await fetchState();
    render(data);
  } catch (err) {
    console.error('Fetch error:', err);
    if (lastSuccess && Date.now() - lastSuccess < 300000) {
      setHealth('stale');
    } else {
      setHealth('offline');
      document.getElementById('loading').style.display = 'none';
    }
  }
}

async function forceRefresh() {
  showNotification('Refreshing market data...', 'info');
  await update();
}

// Initialize
const savedMode = localStorage.getItem('tradeBeaconMode');
if (savedMode && MODES[savedMode]) {
  currentMode = savedMode;
  document.getElementById('btnConservative').classList.toggle('active', savedMode === 'conservative');
  document.getElementById('btnAggressive').classList.toggle('active', savedMode === 'aggressive');
  const config = MODES[savedMode];
  document.getElementById('modeInfo').innerHTML = `<strong>Active Configuration:</strong> ${config.description}`;
  document.getElementById('currentThreshold').textContent = config.threshold;
  document.getElementById('currentADX').textContent = config.minADX || 'None';
  document.getElementById('currentRSI').textContent = 
    config.minADX ? `<${config.rsiOversold} or >${config.rsiOverbought}` : 'Any';
}

// Initial load
update();

// Auto-refresh every 15 seconds
setInterval(update, 15000);
</script>

</body>
</html>
